#!/bin/sh
# ------------------------------------------------------------------------------------------
#
# 	ПРОЕКТ КВАС
#
# ------------------------------------------------------------------------------------------
# 	Данный файл служит основной библиотекой функций пакета КВАС
# ------------------------------------------------------------------------------------------
#	Разработчик: kvas@zeleza.ru
#	Дата: 18/01/2024
#	Лицензия: Apache License 2.0
# ------------------------------------------------------------------------------------------
iface_file=/opt/etc/inface_equals

# ------------------------------------------------------------------------------------------
#
# Получаем конкретный или все интерфейсы роутера в json формате
#
# Передаем имя конкретного CLI интерфейса роутера,
# или ключевое слово all или ALL - для всех интерфейсов
#
# ------------------------------------------------------------------------------------------
get_cli_iface_json(){

    cli_iface="${1:-all}"

    echo "${cli_iface}" | grep -i all && cli_iface=''
    curl -s localhost:79/rci/show/interface/"${cli_iface}"
}
# ------------------------------------------------------------------------------------------
#
# Получаем название конкретного интерфейса
#
# Передаем имя конкретного CLI интерфейса роутера
#
# ------------------------------------------------------------------------------------------
get_iface_description(){
	cli_iface=${1}
    get_cli_iface_json "${cli_iface}" | jq 'description'
}
# ------------------------------------------------------------------------------------------
#
# Проверяем название конкретного интерфейса на то,
# является ли он глобальным интерфейсом - необходим ли он для подключения к провайдеру.
#
# Передаем имя конкретного CLI интерфейса роутера
#
# ------------------------------------------------------------------------------------------
is_cli_iface_global(){
	cli_iface=${1}
    get_cli_iface_json "${cli_iface}" | jq '.global' | grep -q true
}

